{% extends "base.html" %}

{% load history i18n workbench %}

{% block title %}{{ deal }} - {% trans "deals" %} - {{ block.super }}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <h1>{{ deal }} {% history_link deal %}</h1>

    <table class="table table-striped">
      {% for name, value in object|field_value_pairs:'description, owned_by, stage' %}
      <tr><th class="text-right">{{ name }}</th><td>{% link_or_none value %}</td></tr>
      {% endfor %}

      <tr>
        <th class="text-right">{% trans 'estimated value' %}</th>
        <td>{{ deal.estimated_value|currency }}</td>
      </tr>
      <tr>
        <th class="text-right">{% trans 'status' %}</th>
        <td>{{ deal.pretty_status }}</td>
      </tr>
    </table>

    <a href="{{ deal.urls.update }}" class="btn btn-default">
      {% trans 'Update' %}</a>
    <a href="{{ deal.urls.delete }}" class="btn btn-danger btn-inverse pull-right">
      {% trans 'Delete' %}</a>

    <h2>{% trans 'activities' %}</h2>

    <table class="table">
      {% for activity in deal.activities.all %}
        <tr class="{{ activity.css }}">
          <th>
            <a href="{{ activity.urls.detail }}" data-toggle="ajaxmodal">
              {{ activity }}
            </a>
          </th>
          <td>
            {{ activity.owned_by.get_full_name }}
          </td>
          <td>
            {{ activity.pretty_status }}
          </td>
        </tr>
      {% endfor %}
    </table>
    <a href="{% url 'activities_activity_create' %}?deal={{ deal.pk }}"
      class="btn btn-default"
      data-toggle="ajaxmodal">
      <span class="glyphicon glyphicon-plus"></span> {% trans 'activity' %}
    </a>
  </div>
</div>
{% endblock %}
